let storage=localStorage.getItem("absensi_zi"),refresh=localStorage.getItem("refresh");storage||localStorage.setItem("absensi_zi",JSON.stringify([])),refresh||localStorage.setItem("refresh",Date.parse(new Date().setHours(5,0,0)));function q(a){return document.querySelector(a)}function event(b,c,d){let e=c.split(" ");for(const f of e)q(b).addEventListener("click",d,!1)}function drawLine(a,b,c){let d=document.getElementById("canvas"),e=d.getContext("2d");e.beginPath(),e.moveTo(a.x,a.y),e.lineTo(b.x,b.y),e.lineWidth=4,e.strokeStyle=c,e.stroke()}function tick(){let a=document.getElementById("canvas"),b=a.getContext("2d"),c=document.getElementById("loadingMessage");if(c.innerText="\u231B Proses...",video.readyState===video.HAVE_ENOUGH_DATA){c.hidden=!0,a.hidden=!1,a.height=video.videoHeight,a.width=video.videoWidth,b.drawImage(video,0,0,a.width,a.height);var d=b.getImageData(0,0,a.width,a.height),e=jsQR(d.data,d.width,d.height,{inversionAttempts:"dontInvert"});if(e)return drawLine(e.location.topLeftCorner,e.location.topRightCorner,"#13e400"),drawLine(e.location.topRightCorner,e.location.bottomRightCorner,"#13e400"),drawLine(e.location.bottomRightCorner,e.location.bottomLeftCorner,"#13e400"),drawLine(e.location.bottomLeftCorner,e.location.topLeftCorner,"#13e400"),check(e.data)}requestAnimationFrame(tick)}function check(a){let b=JSON.parse(a),c=JSON.parse(localStorage.getItem("absensi_zi"));return sessionStorage.getItem("num")||sessionStorage.setItem("num",1),sessionStorage.getItem("lastId")||sessionStorage.setItem("lastId",b.id),c=c.filter(a=>parseInt(a.id)==parseInt(b.id)),1>c.length?push(a):void(1<c[0].out.split("").length?(Swal.fire({title:"Anda Sudah Keluar",showConfirmButton:!1,timer:1e3,timerProgressBar:!0}),reload(1e3)):1<c[0].in.split("").length&&Swal.fire({title:"Anda Sudah Masuk",text:"Ingin Keluar ? "+b.name,timer:1e3,timerProgressBar:!0,confirmButtonText:"Keluar Sekarang"}).then(a=>{if(a.isConfirmed)return update(JSON.stringify(c[0]));let d=sessionStorage.getItem("num"),e=sessionStorage.getItem("lastId");return parseInt(b.id)==parseInt(e)?(d++,sessionStorage.setItem("num",d)):(sessionStorage.setItem("num",1),sessionStorage.setItem("lastId",b.id)),3<=d?(sessionStorage.removeItem("num"),sessionStorage.removeItem("lastId"),update(JSON.stringify(c[0]))):void reload(50)}))}function push(a){let b=JSON.parse(localStorage.getItem("absensi_zi")),c=JSON.parse(a),d={id:c.id,name:c.name,in:new Date().toString().split(" ")[4],out:""};return b.push(d),localStorage.setItem("absensi_zi",JSON.stringify(b)),toast({title:"Selamat datang",text:c.name,icon:"success"}),reload(2e3)}function update(a){let b=JSON.parse(a),c={id:b.id,name:b.name,in:b.in,out:new Date().toString().split(" ")[4]},d=JSON.parse(localStorage.getItem("absensi_zi"));return d=d.filter(a=>parseInt(a.id)!=parseInt(c.id)),d.push(c),localStorage.setItem("absensi_zi",JSON.stringify(d)),toast({title:"Selamat istirahat",text:b.name,icon:"success"}),reload(2e3)}function toast(a){Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0}).fire(a)}function reload(a){setTimeout(()=>{window.location.reload()},a)}function view(){let b=JSON.parse(localStorage.getItem("absensi_zi")),c="<table style=\"border:1px solid #000;\"><thead><tr><td> Kode </td> <td> Nama </td><td> Masuk </td> <td> Pulang </td></tr></thead><tbody>";for(const d of b)c+=`<tr><td> ${d.id} </td> <td> ${d.name} </td> <td> ${d.in}  </td> <td>  ${d.out}</td></tr>`;c+="</tbody><table>",Swal.fire({title:"Data Absensi",html:` Tanggal ${new Date().toJSON().split("T")[0]} ${c} `,showConfirmButton:!1})}function remove(){Swal.fire({title:"Apa Kamu Yakin Ingin Hapus ?",text:" Dengan menghapus ini, data anda tidak bisa dikembalikan kembali",icon:"warning",showConfirmButton:!0,showDenyButton:!0,confirmButtonText:"Hapus",denyButtonText:"Jangan Hapus"}).then(a=>{a.isConfirmed?(localStorage.setItem("absensi_zi",JSON.stringify([])),toast({title:"Berhasil Dihapus",icon:"success"})):a.isDenied&&toast({title:"Tidak di hapus",icon:"success"})})}function download(){let a=JSON.parse(localStorage.getItem("absensi_zi"));a=a.sort((c,a)=>c.id-a.id);var b=XLSX.utils.book_new(),c=[["no","kode","nama","masuk","keluar"]];a.forEach((a,b)=>{c.push([b,a.id,a.name,a.in,a.out])}),c.push([]),c.push(["rilis",new Date().toJSON().split("T")[0],"",""]);var d=XLSX.utils.aoa_to_sheet(c);XLSX.utils.book_append_sheet(b,d,"absensi");var e=XLSX.write(b,{bookType:"xlsx",bookSST:!1,type:"array"});let f=new Date().toJSON().split("T")[0]+".absensi.xlsx";Swal.fire({title:"Yakin Ingin Download ?",icon:"info",text:"Dengan anda mendownload data absensi, maka data sebelumnya akan terhapus dan tidak bisa dikembalikan kembali",showConfirmButton:!0,confirmButtonText:"Download"}).then(a=>{a.isConfirmed&&(saveAs(new Blob([e],{type:"application/octet-stream"}),f),localStorage.setItem("absensi_zi",JSON.stringify([])),localStorage.setItem("refresh",new Date().setHours(6,0,0,0)))})}function autodownload(){let a=Date.parse(new Date),b=a-localStorage.getItem("refresh");if(b>86400000){Swal.fire("Sedang Download Absensi yang kemaren","","info");let a=JSON.parse(localStorage.getItem("absensi_zi"));a=a.sort((c,a)=>c.id-a.id);var c=XLSX.utils.book_new(),d=[["no","kode","nama","masuk","keluar"]];a.forEach((a,b)=>{d.push([b,a.id,a.name,a.in,a.out])}),d.push([]),d.push(["rilis",new Date().toJSON().split("T")[0],"",""]);var e=XLSX.utils.aoa_to_sheet(d);XLSX.utils.book_append_sheet(c,e,"absensi");var f=XLSX.write(c,{bookType:"xlsx",bookSST:!1,type:"array"});let b=new Date().toJSON().split("T")[0]+".kemaren.absensi.xlsx";saveAs(new Blob([f],{type:"application/octet-stream"}),b),localStorage.setItem("absensi_zi",JSON.stringify([])),localStorage.setItem("refresh",new Date().setHours(6,0,0,0))}}function createQRcode(a){a.preventDefault();let b=document.getElementById("id").value,c=document.getElementById("name").value;Swal.fire({html:`<div id="qrcode"></div> <p style="text-align:center;"> ${c} </p>`,showConfirmButton:!1}),new QRCode(document.getElementById("qrcode"),{text:JSON.stringify({id:b,name:c}),logo:"data:image/png;base64,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",logoWidth:void 0,logoHeight:void 0,logoBackgroundColor:"#ffffffff",logoBackgroundTransparent:!0,width:256,height:256})}autodownload();